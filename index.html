<!DOCTYPE html>
<html lang="de">

<head>
    <title>PWA</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="manifest" href="manifest.json">
    <style>

    </style>

    <script>
        window.addEventListener("beforeinstallprompt", event => {
            // Suppress automatic prompting.
            event.preventDefault();


            install.addEventListener('click', async e => {
                install.hidden = true;
                const userChoice = await event.prompt();
                alert(`user choice was: ${userChoice.outcome} / platform: ${userChoice.platform}`);
            })

            install.hidden = false;
        });

        if ("launchQueue" in window) {
            window.launchQueue.setConsumer(async (launchParams) => {
                if (launchParams.files) {
                    const [fileHandle] = launchParams.files;
                    const fileData = await fileHandle.getFile();

                    document.title = fileData.name
                    console.log(fileData)
                    let writable = await fileHandle.createWritable();
                    await writable.write("contents");
                    await writable.close();

                    writable = await fileHandle.createWritable();
                    await writable.write("contents2");
                    await writable.close();
                }
            });
        }
    </script>
</head>

<body>
    PWA

    <button id="install" hidden>Install</button>
</body>

</html>